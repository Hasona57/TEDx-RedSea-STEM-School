<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TEDx Red Sea STEM</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <style>
    .modal-content {
      max-height: 90vh;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: #e11d48 #1a1a1a;
    }

    .modal-content::-webkit-scrollbar {
      width: 8px;
    }

    .modal-content::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 4px;
    }

    .modal-content::-webkit-scrollbar-thumb {
      background: #e11d48;
      border-radius: 4px;
    }

    #image_preview {
      max-height: 300px;
      object-fit: contain;
      border-radius: 8px;
      border: 2px solid #333;
      background: #1a1a1a;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-status {
      margin-top: 15px;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
    }

    input[type="file"] {
      padding: 10px;
      background: #1a1a1a;
      border: 2px dashed #333;
      border-radius: 8px;
      width: 100%;
      cursor: pointer;
      color: #fff;
    }

    input[type="file"]:hover {
      border-color: #e11d48;
    }

    .price-summary {
      background: #1a1a1a;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }

    .price-summary h3 {
      color: #e11d48;
      margin: 0;
    }
  </style>
</head>
<body>
  <div id="preloader">
    <div class="preloader-ring"></div>
    <img src="images/logo.png" alt="TEDx Logo" class="preloader-logo" />
  </div>

  <!-- Add Loading Spinner -->
  <div id="loading-spinner" class="loading-spinner">
    <div class="spinner"></div>
    <div class="loading-text">Processing your request...</div>
  </div>

  <!-- Add Notification Modal -->
  <div id="notification-modal" class="notification-modal">
    <div class="notification-content">
      <h3 id="notification-title"></h3>
      <p id="notification-message"></p>
      <button class="notification-btn" onclick="closeNotification()">OK</button>
    </div>
  </div>

  <header class="navbar">
    <div class="nav-container">
      <img src="images/logo.png" alt="TEDx Logo" class="nav-logo">
      <nav>
        <a href="#about">About</a>
        <a href="#gallery">Gallery</a>
        <a href="#team">Team</a>
        <a href="#sponsors">Sponsors</a>
        <a href="#speakers">Speakers</a>
        <a href="#venue">Venue</a>
        <a href="#tickets">tickets</a>
        <a href="#faq">FAQ</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="overlay">
      <div class="hero-content">
        <img src="images/logo.png" class="hero-logo" alt="TEDx Logo" />
        <h1>TEDxRedSeaSTEM</h1>
        <p class="tagline">Ideas Worth Spreading</p>
        <p class="date">Coming November 2025</p>
      </div>
    </div>
  </section>

  <section id="about" class="section">
    <h2>About TEDx</h2>
    <p>
      TEDxRedSeaSTEM is organized by Red Sea STEM School students to share transformative ideas and innovations with the world, in the spirit of TED.
    </p>
  </section>

  <section id="gallery" class="section dark">
    <h2>Gallery</h2>
    <div class="gallery-grid">
      <img src="images/gallery1.jpg" alt="Gallery Image">
      <img src="images/gallery2.jpg" alt="Gallery Image">
      <img src="images/gallery3.jpg" alt="Gallery Image">
    </div>
  </section>

  <section id="sponsors" class="section">
    <h2>Our Sponsors</h2>
    <div class="sponsor-logos">
      <img src="images/sponsor1.png" alt="Sponsor 1">
      <img src="images/sponsor2.png" alt="Sponsor 2">
      <img src="images/sponsor3.png" alt="Sponsor 3">
    </div>
  </section>

  <section id="speakers" class="section dark">
    <h2>Featured Speakers</h2>
    <div class="card-grid">
      <div class="card">
        <img src="images/speaker1.jpg" alt="Speaker 1" />
        <h3>Dr. Amina Youssef</h3>
        <p>STEM Advocate & Educator</p>
      </div>
      <div class="card">
        <img src="images/speaker2.jpg" alt="Speaker 2" />
        <h3>Omar El-Sayed</h3>
        <p>Entrepreneur & Innovator</p>
      </div>
    </div>
  </section>

  <section id="venue" class="section">
    <h2>Event Venue</h2>
    <p>Red Sea STEM School Auditorium</p>
    <p>November 15, 2025 – 10:00 AM to 2:00 PM</p>
    <iframe class="map" src="https://maps.google.com/maps?q=Red%20Sea%20STEM%20School&t=&z=13&ie=UTF8&iwloc=&output=embed"></iframe>
  </section>

    <section id="tickets" class="section dark">
    <h2>Tickets</h2>
    <div class="ticket-container">
      <div class="ticket-card">
        <h3>Early Bird Ticket</h3>
        <div class="price">EGP 525</div>
        <ul>
          <li>Access to all sessions</li>
          <li>Event swag bag</li>
          <li>Lunch and refreshments</li>
          <li>Networking opportunities</li>
          <li>8 inspiring speakers</li>
        </ul>
        <button class="btn" onclick="openCheckout('Early Bird')">Select</button>
      </div>
      <div class="ticket-card">
        <h3>Late Owl</h3>
        <p class="price">EGP 600</p>
        <ul>
          <li>Breakfast, lunch, and snack break</li>
          <li>Access to all student activities</li>
          <li>Online ticket sent by email</li>
          <li>Secure online payment</li>
          <li>8 inspiring speakers</li>
        </ul>
        <button class="btn disabled" disabled>Sold Out</button>
      </div>
    </div>
    </section>

  <section id="faq" class="section dark">
    <h2>FAQ</h2>
    <div class="faq">
      <details>
        <summary>Is the event open to the public?</summary>
        <p>Yes, but registration is required due to limited seating.</p>
      </details>
      <details>
        <summary>Will it be live streamed?</summary>
        <p>Yes, the event will be streamed on our YouTube channel.</p>
      </details>
    </div>
  </section>
  
<section id="contact" class="section">
  <h2>Contact Us</h2>
  <form id="contact-form" class="contact-form" onsubmit="submitContactForm(event)">
    <input type="text" name="name" placeholder="Your Name" required />
    <input type="email" name="email" placeholder="Your Email" required />
    <textarea name="message" placeholder="Your Message" required></textarea>
    <button type="submit" class="btn-primary">Send Message</button>
  </form>
  <p id="contact-status" class="form-status"></p>
  </section>

<section id="team" class="section dark">
  <h2>Meet the Team</h2>
  <div class="team-scroll-wrapper">
  <div class="team-container">
    <div class="team-card">
      <img src="images/salma.jpeg" alt="Member 1" class="team-img" />
      <h3 class="team-name">Salma Mohamed</h3>
      <p class="team-role">Chairwoman</p>
    </div>
    <div class="team-card">
      <img src="images/Ahmed Afify.jpg" alt="Member 2" class="team-img" />
      <h3 class="team-name">Ahmed Afify</h3>
      <p class="team-role">CFO</p>
    </div>
    <div class="team-card">
      <img src="images/Mohamed zidan.jpg" alt="Member 3" class="team-img" />
      <h3 class="team-name">Mohamed zidan</h3>
      <p class="team-role">CEO</p>
    </div>
    <div class="team-card">
      <img src="images/Basma Ashour.jpg" alt="Member 4" class="team-img" />
      <h3 class="team-name">Basma Ashour</h3>
      <p class="team-role">HR Manager</p>
    </div>
    <div class="team-card">
      <img src="images/Yusuf El-badry.jpg" alt="Member 5" class="team-img" />
      <h3 class="team-name">Yusuf El-badry</h3>
      <p class="team-role">COO</p>
    </div>
    <div class="team-card">
      <img src="images/Hassan.png" alt="Member 6" class="team-img" />
      <h3 class="team-name">Hassan Mohamed</h3>
      <p class="team-role">IT ViceHead</p>
    </div>
    </div>
  </div>
</section>

  <div id="checkout-modal" class="modal hidden">
  <div class="modal-content">
    <span class="close" onclick="closeCheckout()">&times;</span>
    <h2>Checkout</h2>
    <div id="ticket-summary"></div>

    <form id="checkout-form" onsubmit="submitCheckoutForm(event)">
      <div class="form-group">
        <label for="user_name">Full Name</label>
        <input type="text" id="user_name" name="user_name" required>
      </div>

      <div class="form-group">
        <label for="user_email">Email</label>
        <input type="email" id="user_email" name="user_email" required>
      </div>

      <div class="form-group">
        <label for="whatsapp">WhatsApp Number</label>
        <input type="tel" id="whatsapp" name="whatsapp" 
          pattern="^\+?[1-9]\d{1,14}$"
          placeholder="+20XXXXXXXXXX"
          title="Please enter a valid phone number with country code"
          required>
      </div>

      <div class="form-group">
        <label for="promo_code">Promo Code (Optional)</label>
        <div class="promo-container" style="display: flex; gap: 10px;">
          <input type="text" id="promo_code" name="promo_code" placeholder="Enter promo code if you have one" style="flex: 1;">
          <button type="button" class="btn-secondary" onclick="validatePromoCode()">Apply</button>
        </div>
      </div>

      <div class="form-group">
        <label for="transaction_image">Transaction Screenshot</label>
        <input type="file" id="transaction_image" name="transaction_image" accept="image/*" onchange="previewImage(this)" required>
        <img id="image_preview" style="max-width: 100%; margin-top: 10px; display: none;" alt="Transaction Preview">
      </div>

      <div class="price-summary">
        <h3>Ticket Price: EGP 525</h3>
        <p id="discount-info" style="margin-top: 10px; font-size: 0.9rem;"></p>
      </div>

      <input type="hidden" name="ticket_type" id="ticket_type">
      <button type="submit" class="btn-primary">Submit Purchase</button>
      <div id="checkout-form-status" class="form-status"></div>
    </form>
  </div>
</div>

  <footer>
    &copy; 2025 TEDxRedSeaSTEM | Powered by Red Sea STEM School Students
  </footer>

<!-- Add hidden iframe for form submissions -->
<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

<script>
    // Add iframe load handler
    window.addEventListener('load', function() {
      const iframe = document.getElementById('hidden_iframe');
      
      iframe.addEventListener('load', function() {
        try {
          hideLoading();
          // Check if this was triggered by a form submission
          if (window.lastSubmittedForm === 'checkout') {
            showNotification(
              'Purchase Successful!',
              'Your ticket purchase has been submitted. Please check your email for confirmation.',
              'success'
            );
            document.getElementById('checkout-form').reset();
            document.getElementById('image_preview').style.display = 'none';
            setTimeout(() => {
              closeModal();
            }, 3000);
          } else if (window.lastSubmittedForm === 'contact') {
            showNotification(
              'Message Sent!',
              'Your message has been sent successfully. We\'ll get back to you soon.',
              'success'
            );
            document.getElementById('contact-form').reset();
          }
          window.lastSubmittedForm = null;
        } catch (error) {
          showNotification(
            'Error',
            'An error occurred. Please try again.',
            'error'
          );
        }
      });
    });

    window.addEventListener("load", function () {
  const preloader = document.getElementById("preloader");
  if (preloader) {
    setTimeout(() => {
      preloader.style.display = "none";
    }, 2000);
  }
});

    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw0nXT433DKij04dw9mfX0UDnDNjcH5B4EAxV14TwhJpCzU0XCybc6J2oplGQleO272Sw/exec';
    const CONTACT_FORM_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw0nXT433DKij04dw9mfX0UDnDNjcH5B4EAxV14TwhJpCzU0XCybc6J2oplGQleO272Sw/exec';

      // Team member promo codes (no discounts, just for tracking)
  const PROMO_CODES = {
        'BN2025': 'Bissan Nasr',
        'AM2025': 'Amira Mohamed',
        'EA2025': 'Eyad Abdulhafiz',
        'RE2025': 'Radwa Elherzawy',
        'OH2025': 'Omar hamed',
        'MH2025': 'Mohamed Hamdy',
        'MS2025': 'Mayar Sadek',
        'MA2025': 'Mariam aseem',
        'OA2025': 'Omar Ashraf',
        'SM2025': 'Shahd Muhammad',
        'AH2025': 'Asmaa Hassan',
        'AA2025': 'Anas Ahmed',
        'MM2025': 'Mahmoud Mohammed',
        'RR2025': 'Rahma Ramadan',
        'SA2025': 'Saif Ahmed',
        'MT2025': 'Mohamed Tamer',
        'MA2025B': 'Mohaned Ahmed',
        'AS2025': 'Alkasem Soliman',
        'JM2025': 'Jana Mahmoud',
        'YS2025': 'Youseff samir',
        'MS2025B': 'Mohaned sameer',
        'MA2025C': 'Mohamed ali',
        'SM2025B': 'Sama Mohamed',
        'HT2025': 'HajerTarek',
        'JA2025': 'Jenny Adel',
        'MM2025B': 'MARAIM MOHAMED',
        'BM2025': 'Basmala Mahmoud',
        'MM2025C': 'Mahmoud Mohamed',
        'PZ2025': 'Pishoy Zarif',
        'RA2025': 'Rowida Arafa',
        'MA2025D': 'Moataz Ahmed',
        'OH2025B': 'Omar Hazem',
        'MG2025': 'Mohamed Gomaa',
        'EH2025': 'el-shimaa hassan',
        'RA2025B': 'Retaj Ahmed',
        'MH2025B': 'Muhammed Hassan',
        'SA2025B': 'Shahd abdelatti',
        'MA2025E': 'Malak Ahmed',
        'AS2025B': 'Asmaa Saber',
        'MA2025F': 'Mohamed Amin',
        'ZA2025': 'Ziad Ahmed',
        'MM2025D': 'Moaz Mohammad',
        'YA2025': 'Youssef ahmed',
        'NH2025': 'Noor hameed',
        'AE2025': 'Ahmed Eion',
        'OE2025': 'Omar eion',
        'NM2025': 'Nada Magdy',
        'HF2025': 'Hana Fathy',
        'YM2025': 'Yara Mohamed',
        'MM2025E': 'malk mohy',
        'AR2025': 'Allaa Reda',
        'MM2025F': 'Malak medhat',
        'SA2025C': 'Salma Ahmed',
        'AA2025B': 'احمد علاء',
        'HT2025B': 'Habiba Tarek',
        'HA2025': 'Haneen Ali',
        'SM2025C': 'Shrouk Mahmoud',
        'MA2025G': 'Marwa Ali',
        'AY2025': 'Ahmed Yahia',
        'AB2025': 'Ahmed Bassem',
        'RH2025': 'Retaj Hagag',
        'OE2025B': 'omarElkady',
        'HH2025': 'Habiba Hassanain',
        'MG2025B': 'Mariem gamal',
        'MA2025H': 'Malak Ahmed',
        'RM2025': 'Rana Mohamed',
        'MH2025C': 'Mohamed hael',
        'MA2025I': 'Mohamed Ahmed',
        'GA2025': 'Ganna Ahmed',
        'SE2025': 'Sophia Essam',
        'OM2025': 'Omar Medhat',
        'OA2025B': 'omnia ashraf',
        'MM2025G': 'Malak Mustafa',
        'RA2025C': 'Raghda Abdelhamid',
        'RK2025': 'Radwa Khalled',
        'HA2025B': 'Habiba Ahmed',
        'HA2025C': 'Hoda Ahmed',
        'AA2025C': 'Àlaa Ayman',
        'MA2025J': 'Menna Ali',
        'HS2025': 'Hana shaban',
        'OA2025C': 'Omnia Alaa',
        'AG2025': 'Ahmed Gharieb',
        'NA2025': 'Nada Ashraf',
        'MM2025H': 'Mostafa mohamed',
        'AN2025': 'Ahmed Nasr',
        'DD2025': 'Dina Diab',
        'RS2025': 'Renad Sameh',
        'SM2025D': 'Shahd mahmoud'
      };

      // Function to validate promo code
      function validatePromoCode() {
        const promoCode = document.getElementById("promo_code").value.trim().toUpperCase();
        const discountInfo = document.getElementById("discount-info");
        
        if (!promoCode) {
          discountInfo.textContent = "";
          return;
        }

        if (PROMO_CODES[promoCode]) {
          discountInfo.textContent = "Valid promo code!";
          discountInfo.style.color = "#4ade80"; // Success color
        } else {
          discountInfo.textContent = "Invalid promo code";
          discountInfo.style.color = "#ef4444"; // Error color
        }
      }

      // Initialize the form
    function openCheckout(type) {
    document.getElementById("checkout-modal").classList.remove("hidden");
      document.getElementById("ticket_type").value = type;
    }

    function closeModal() {
      document.getElementById("checkout-modal").classList.add("hidden");
      document.getElementById("promo_code").value = "";
      document.getElementById("discount-info").textContent = "";
      document.getElementById('image_preview').style.display = 'none';
    }

    function updatePriceSummary(type, basePrice, finalPrice) {
    document.getElementById("ticket-summary").innerHTML = `
      <h3>${type}</h3>
        <p>Base Price: EGP ${basePrice}</p>
    `;
      document.getElementById("final-price").textContent = `EGP ${finalPrice}`;
  }

  function closeCheckout() {
    document.getElementById("checkout-modal").classList.add("hidden");
  }

    function previewImage(input) {
      const preview = document.getElementById('image_preview');
      const file = input.files[0];

      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.src = e.target.result;
          preview.style.display = 'block';
          
          // Scroll to make the preview visible
          setTimeout(() => {
            preview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 100);
        }
        reader.readAsDataURL(file);
    } else {
        preview.style.display = 'none';
        preview.src = '';
      }
    }

    function applyPromo() {
      const promoCode = document.getElementById("promo").value.toUpperCase();
      const basePrice = parseFloat(document.querySelector("[name='ticket_price']").value);
      const discountInfo = document.getElementById("discount-info");
      
      // Promo code validation is handled by the server
      const discount = PROMO_CODES[promoCode] || 0; // Default to 0 if not found
      const finalPrice = basePrice * (1 - discount);
      
      document.querySelector("[name='final_price']").value = finalPrice;
      discountInfo.textContent = `Discount applied: ${discount * 100}% off`;
      document.getElementById("final-price").textContent = `EGP ${finalPrice}`;
    }

    function showLoading(message = 'Processing your request...') {
      document.querySelector('#loading-spinner .loading-text').textContent = message;
      document.getElementById('loading-spinner').classList.add('active');
    }

    function hideLoading() {
      document.getElementById('loading-spinner').classList.remove('active');
    }

    function showNotification(title, message, type = 'success') {
      const modal = document.getElementById('notification-modal');
      const content = modal.querySelector('.notification-content');
      const titleEl = document.getElementById('notification-title');
      const messageEl = document.getElementById('notification-message');

      content.className = 'notification-content ' + type;
      titleEl.textContent = title;
      messageEl.textContent = message;
      modal.classList.add('active');
    }

    function closeNotification() {
      document.getElementById('notification-modal').classList.remove('active');
    }

    async function submitCheckoutForm(event) {
      event.preventDefault();
      showLoading('Processing your purchase...');
      
      const form = event.target;
      
      try {
        // Get the image file
        const imageFile = document.getElementById('transaction_image').files[0];
        if (!imageFile) {
          throw new Error('Please upload a transaction screenshot');
        }

        // Convert image to base64
        const base64Image = await new Promise((resolve) => {
          const reader = new FileReader();
          reader.onloadend = () => resolve(reader.result);
          reader.readAsDataURL(imageFile);
        });

        // Create a new FormData instance
        const formData = new FormData();
        
        // Add all form fields
        formData.append('name', form.querySelector('[name="user_name"]').value);
        formData.append('email', form.querySelector('[name="user_email"]').value);
        formData.append('whatsapp', form.querySelector('[name="whatsapp"]').value);
        formData.append('ticket_type', form.querySelector('[name="ticket_type"]').value);
        formData.append('promo_code', form.querySelector('[name="promo_code"]').value || '');
        formData.append('base_price', '525');
        formData.append('transaction_image', base64Image);

        // Create a temporary form for submission
        const tempForm = document.createElement('form');
        tempForm.method = 'POST';
        tempForm.action = GOOGLE_SCRIPT_URL;
        tempForm.target = 'hidden_iframe';

        // Add all form data as hidden inputs
        for (let [key, value] of formData.entries()) {
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = key;
          input.value = value;
          tempForm.appendChild(input);
        }

        // Add the form to the document, submit it, and remove it
        document.body.appendChild(tempForm);
        window.lastSubmittedForm = 'checkout';
        tempForm.submit();
        document.body.removeChild(tempForm);
        
      } catch (error) {
        hideLoading();
        showNotification(
          'Error',
          error.message || 'An error occurred. Please try again.',
          'error'
        );
      }
    }

    async function submitContactForm(event) {
      event.preventDefault();
      showLoading('Sending your message...');
      
      const form = event.target;
      
      try {
        // Create a temporary form for submission
        const tempForm = document.createElement('form');
        tempForm.method = 'POST';
        tempForm.action = CONTACT_FORM_SCRIPT_URL;
        tempForm.target = 'hidden_iframe';

        // Add form data as hidden inputs
        const formData = {
          'name': form.name.value,
          'email': form.email.value,
          'message': form.message.value,
          'timestamp': new Date().toISOString()
        };

        // Add all form data as hidden inputs
        Object.entries(formData).forEach(([key, value]) => {
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = key;
          input.value = value;
          tempForm.appendChild(input);
        });

        // Add the form to the document, submit it, and remove it
        document.body.appendChild(tempForm);
        window.lastSubmittedForm = 'contact';
        tempForm.submit();
        document.body.removeChild(tempForm);
        
      } catch (error) {
        hideLoading();
        showNotification(
          'Error',
          'Error sending message. Please try again.',
          'error'
        );
      }
    }
</script>
</body>
</html>
